#!/bin/bash
set -e

# Solo en producciÃ³n queremos preparar/sembrar la base de datos
if [ "$RAILS_ENV" = "production" ]; then
  if [ "$RESET_VOLUMES" = "true" ]; then
    echo "ğŸ”„ RESET_VOLUMES=true â†’ ejecutando db:setup (create + migrate + seed)"
    bundle exec rails db:setup
  else
    echo "âš™ï¸ RESET_VOLUMES!=true â†’ ejecutando db:prepare"
    bundle exec rails db:prepare
  fi
fi

# Luego ejecuta el CMD normal (ej. Puma)
exec "$@"
